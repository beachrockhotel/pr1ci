language: go

go:
  - "1.21"

before_install:
  - wget https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-4.8.0.2856-linux.zip
  - unzip sonar-scanner-cli-4.8.0.2856-linux.zip
  - export PATH=$PATH:$PWD/sonar-scanner-4.8.0.2856-linux/bin

addons:
  sonarcloud:
    organization: "zxcnevermorezxc"
    token:
      secure: "$SONAR_TOKEN"

script:
  - go test ./... -v -coverprofile=coverage.out
  - sonar-scanner
